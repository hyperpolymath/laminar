# SPDX-License-Identifier: Apache-2.0
# SPDX-FileCopyrightText: 2025 Laminar Contributors
#
# Prometheus Configuration for Laminar

global:
  scrape_interval: 15s
  evaluation_interval: 15s
  external_labels:
    monitor: 'laminar'

# Alertmanager configuration (optional)
# alerting:
#   alertmanagers:
#     - static_configs:
#         - targets: ['alertmanager:9093']

# Rule files
# rule_files:
#   - '/etc/prometheus/rules/*.yml'

scrape_configs:
  # Control Plane metrics (Phoenix/Telemetry)
  - job_name: 'control-plane'
    static_configs:
      - targets: ['control-plane:9568']
    metrics_path: '/metrics'
    scheme: 'http'

  # Rclone Relay metrics
  - job_name: 'relay'
    static_configs:
      - targets: ['relay:5572']
    metrics_path: '/core/stats'
    scheme: 'http'
    # Rclone doesn't export Prometheus format natively
    # Use a custom parser or relay metrics through control-plane

  # Rclone Refinery metrics
  - job_name: 'refinery'
    static_configs:
      - targets: ['refinery:5572']
    metrics_path: '/core/stats'
    scheme: 'http'

  # Prometheus self-monitoring
  - job_name: 'prometheus'
    static_configs:
      - targets: ['localhost:9090']

  # Node exporter (if deployed)
  # - job_name: 'node'
  #   static_configs:
  #     - targets: ['node-exporter:9100']
